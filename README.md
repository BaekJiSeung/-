이 코드의 목적은 감염병의 혈청 유병률(seroprevalence) 데이터를 분석하여 감염력(force of infection, FOI)을 추정하는 것입니다. FOI는 질병이 특정 인구 내에서 전파되는 속도를 나타내는 중요한 역학적 매개변수입니다. 이를 통해 감염병의 전파 특성을 이해하고, 향후 감염 확산을 예측하는 데 도움이 됩니다.

모티베이션
감염병의 전파를 이해하고 예측하는 것은 공중 보건 및 역학 연구에서 매우 중요합니다. FOI는 이러한 예측에 핵심적인 역할을 하며, 특정 연령대에서 감염이 발생하는 비율을 파악하는 데 사용됩니다. 혈청 유병률 데이터는 특정 연령대에서 얼마나 많은 사람들이 항체를 보유하고 있는지를 나타내며, 이는 과거 감염 여부를 간접적으로 알 수 있게 해줍니다. 본 코드의 목적은 혈청 유병률 데이터를 기반으로 FOI를 추정하여 감염병의 전파 동향을 이해하고 예측하는 것입니다.

데이터 획득 방법
이 코드에서는 두 개의 CSV 파일(seroprevalence_uk.csv 및 seroprevalence_china.csv)을 사용합니다. 이 파일들은 각기 다른 지역(영국과 중국)에서 수집된 혈청 유병률 데이터를 포함하고 있습니다. 각 파일은 다음과 같은 열을 포함합니다:

time_stamp: 특정 연령대 (연령을 의미)
Pa: 특정 연령대에서 양성으로 판정된 사람 수
Na: 특정 연령대에서 조사된 전체 사람 수
이 데이터를 통해 각 연령대의 혈청 유병률을 계산할 수 있습니다.

모델
모델은 주어진 연령대(time_stamp)에서 FOI (λ)를 추정하는 것을 목표로 합니다. 이를 위해 다음과 같은 수학적 표현을 사용합니다:

expected = 1 - exp(-initial_guess * time_stamp): 초기 추정치(initial_guess)를 기반으로 계산된 혈청 유병률
error = sum((expected - data) ** 2): 초기 추정치와 실제 데이터 간의 오차 제곱합
모델은 이 오차를 최소화하는 λ 값을 찾기 위해 scipy.optimize 모듈의 minimize 함수를 사용합니다. 이 과정에서 주어진 초기 추정치(initial_guess)를 사용하여 최적화가 진행됩니다.

퍼포먼스
코드는 다음의 주요 퍼포먼스 지표를 제공합니다:

error: 초기 추정치와 실제 데이터 간의 오차 제곱합
est: 최적화된 FOI (λ)
final_error: 최적화된 FOI와 실제 데이터 간의 최종 오차 제곱합
이 퍼포먼스 지표를 통해 초기 추정치와 최적화된 추정치 간의 차이를 비교할 수 있으며, 모델의 정확도를 평가할 수 있습니다.

코드 상세 설명
클래스 초기화: Solution 클래스는 연령대(time_stamp), 혈청 유병률 데이터(data), 초기 추정치(initial_guess)를 입력으로 받습니다.
FOI 추정 메서드: get_seroprev_from_foi 메서드는 초기 추정치를 기반으로 예상 혈청 유병률(expected)을 계산하고, 실제 데이터와의 오차(error)를 계산합니다. 그런 다음, 최적화된 FOI(est)를 찾기 위해 오차 제곱합을 최소화하는 최적화를 수행합니다.
데이터 시각화: 초기 추정치와 최적화된 추정치를 시각적으로 비교하기 위해 그래프를 그립니다.
데이터 분석: CSV 파일로부터 데이터를 읽어와 혈청 유병률을 계산하고, 이를 기반으로 FOI를 추정합니다.
출력: 각 분석 결과를 출력하여 초기 오차, 최적화된 FOI, 최종 오차를 확인합니다.
UK 데이터와 중국 데이터 분석
코드는 UK 데이터와 중국 데이터를 각각 분석합니다. 각 데이터 세트에 대해 초기 추정치와 최적화된 FOI를 계산하고, 이를 비교하여 각 지역에서의 감염병 전파 특성을 파악합니다. 또한, UK 데이터를 두 부분으로 나누어 각각에 대해 분석을 수행함으로써 데이터의 시간적 변화에 따른 FOI의 변화를 관찰할 수 있습니다.

결론
이 코드의 궁극적인 목표는 혈청 유병률 데이터를 통해 감염병의 전파 속도를 추정하고, 이를 통해 공중 보건 전략을 수립하는 데 필요한 정보를 제공하는 것입니다. FOI의 정확한 추정은 감염병의 동향을 예측하고 적절한 대응책을 마련하는 데 중요한 역할을 합니다.
